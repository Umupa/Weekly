---
interface Props {
  issue: number;
  title: string;
  date: Date;
  description: string;
  image: string;
}

const { issue, title, date, description, image } = Astro.props;

// 格式化日期为 YYYY/MM/DD
const formattedDate = date.toLocaleDateString('zh-CN', {
  year: 'numeric',
  month: '2-digit',
  day: '2-digit'
}).replace(/-/g, '/');
---

<a
  href={`/posts/${issue}`}
  class="card-link"
>
  <img
    src={image}
    alt={`第${issue}期 - ${title}`}
    loading="lazy"
    class="card-image"
  />
  <div class="card-header">
    <div class="card-title">第{issue}期 - {title}</div>
    <div class="card-date">{formattedDate}</div>
  </div>
  <p class="card-desc">{description}</p>
</a>

<style>
  .card-link {
    display: flex;
    flex-direction: column;
    justify-content: center;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    overflow: hidden;
    background: var(--bg);
    text-decoration: none;
    transition: all 200ms ease;
    will-change: transform;
    margin-top: 20px;
    padding-bottom: 12px;
  }

  .card-link:hover {
    box-shadow: 0 8px 16px -2px rgb(0 0 0 / 0.12), 0 4px 8px -2px rgb(0 0 0 / 0.08);
  }

  .card-link:hover .card-image {
    transform: scale(1.02);
    filter: brightness(1.05);
  }

  .card-image {
    display: block;
    width: 100%;
    height: 192px;
    object-fit: cover;
    border-radius: 8px 8px 0 0;
    transition: transform 200ms ease;
    background: linear-gradient(to bottom, #ece9e6, #ffffff);
  }

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 12px 0;
    line-height: 1.4;
  }

  .card-title {
    font-size: 1rem;
    font-weight: 600;
    color: #1f2937;
  }

  .card-date {
    font-size: 0.875rem;
    color: #4b5563;
    flex-shrink: 0;
  }

  .card-desc {
    padding: 8px 12px 0;
    margin: 0;
    font-size: 0.875rem;
    color: #4b5563;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    height: 48px;
  }

  /* Dark mode */
  :global([data-theme='dark']) .card-title {
    color: #e5e7eb;
  }

  :global([data-theme='dark']) .card-date,
  :global([data-theme='dark']) .card-desc {
    color: #d1d5db;
  }

  :global([data-theme='dark']) .card-image {
    background: linear-gradient(to bottom, #2c3e50, #34495e);
  }

  :global([data-theme='dark']) .card-link {
    box-shadow: 0 2px 5px -1px rgb(0 0 0 / 0.18), 0 1px 5px -1px rgb(0 0 0 / 0.18);
  }

  /* 移动端样式 */
  @media (max-width: 768px) {
    .card-link {
      margin-top: 16px;
    }

    .card-image {
      height: 208px;
    }

    .card-title {
      font-size: 1.125rem;
    }

    .card-date {
      font-size: 1rem;
    }

    .card-desc {
      font-size: 1rem;
      height: 56px;
    }
  }
</style>
